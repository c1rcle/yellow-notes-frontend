(this["webpackJsonpyellow-notes-frontend"]=this["webpackJsonpyellow-notes-frontend"]||[]).push([[0],{107:function(e,t,a){},109:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),s=a.n(c),l=a(19),o=a(22),i=a(111),u=a(9),m=a(118),d=a(112),p=a(119),E=a(75),f=a(6),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isUserLoggedIn:!1},t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"CHECK_TOKEN":return Object(f.a)({isUserLoggedIn:!1},n);case"REGISTER":return Object(f.a)({},n,{isUserLoggedIn:!0});case"REGISTER_FAILED":return alert("That email is already occupied, you imposter!"),{isUserLoggedIn:!1,errorMessage:{type:"REGISTER",text:"Email is occupied!"}};case"LOGIN":return Object(f.a)({},n,{isUserLoggedIn:!0});case"LOGIN_FAILED":return alert("Your login is no good!"),{isUserLoggedIn:!1,errorMessage:{type:"LOGIN",text:"Wrong email / password!"}};case"ADD_NOTE":var r=0;return e.notes&&(r=0===e.notes.length?0:e.notes[e.notes.length-1].id+1),Object(f.a)({},e,{notes:[].concat(Object(E.a)(e.notes||[]),[Object(f.a)({},n,{id:r})])});case"LOGOUT":return{isUserLoggedIn:!1};default:return e}},b=a(14),h=a.n(b),v=a(20),w=a(60),y=a.n(w).a.create({baseURL:"https://api.yellownotes.c1rcle.pl/",timeout:1e3,headers:localStorage.getItem("token")?{Authorization:"Bearer "+localStorage.getItem("token")}:{}}),O=function(){var e=Object(v.a)(h.a.mark((function e(t){var a,n,r,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.payload,n=a.email,r=a.password,a&&r&&n&&2===Object.keys(a).length){e.next=4;break}throw new Error("Registration request has invalid parameters!");case 4:return e.prev=4,e.next=7,y.post("users/register",Object(f.a)({},a));case 7:c=e.sent,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),c={status:400},console.error(e.t0);case 14:if(200===c.status){e.next=16;break}return e.abrupt("return",{type:"REGISTER_FAILED"});case 16:return localStorage.setItem("token",c.data.token),e.abrupt("return",Object(f.a)({},t,{payload:{email:n}}));case 18:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(v.a)(h.a.mark((function e(t){var a,n,r,c,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[{id:0,content:"Some example text"},{id:1,content:"Some example text"},{id:2,content:"Some example text"},{id:3,content:"Some example text"},{id:4,content:"Multi \nline \ntext"}],n=t.payload,r=n.email,c=n.password,n&&c&&r&&2===Object.keys(t.payload).length){e.next=5;break}throw new Error("Login request has invalid parameters!");case 5:return e.prev=5,e.next=8,y.post("users/authenticate",n);case 8:s=e.sent,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(5),s={status:400},console.error(e.t0);case 15:if(200===s.status){e.next=17;break}return e.abrupt("return",{type:"LOGIN_FAILED"});case 17:return localStorage.setItem("token",s.data.token),e.abrupt("return",Object(f.a)({},t,{payload:{email:r,notes:a}}));case 19:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(v.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.payload&&t.payload.content&&1===Object.keys(t.payload).length){e.next=2;break}throw new Error("Registration request has invalid parameters!");case 2:e.prev=2,a={status:200,data:{content:t.payload.content}},e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(2),new Error("Registration request has did not succeed! ",a);case 9:if(200===a.status){e.next=11;break}throw new Error("Registration request has did not succeed! ",a);case 11:return e.abrupt("return",Object(f.a)({},t,{payload:a.data}));case 12:case"end":return e.stop()}}),e,null,[[2,6]])})));return function(t){return e.apply(this,arguments)}}(),j=a(61),k=a.n(j),I=function(){var e=Object(v.a)(h.a.mark((function e(t){var a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=localStorage.getItem("token")){e.next=3;break}return e.abrupt("return",t);case 3:if(!((n=k()(a)).exp<(new Date).getTime()/1e3)&&n.email){e.next=7;break}return localStorage.removeItem("token"),e.abrupt("return");case 7:return e.abrupt("return",Object(f.a)({},t,{payload:{isUserLoggedIn:!0,email:n.email}}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){return function(t){switch(t.type){case"CHECK_TOKEN":I(t).then((function(t){return e(t)})).catch((function(e){return console.log(e)}));break;case"REGISTER":O(t).then((function(t){return e(t)})).catch((function(e){return console.log(e)}));break;case"LOGIN":x(t).then((function(t){return e(t)})).catch((function(e){return console.log(e)}));break;case"LOGOUT":localStorage.removeItem("token"),e(t);break;case"ADD_NOTE":N(t).then((function(t){return e(t)})).catch((function(e){return console.log(e)}));break;default:e(t)}}},T=Object(n.createContext)();function R(e){var t=e.children,a=Object(n.useReducer)(g,{}),c=Object(u.a)(a,2),s=c[0],l=c[1];return r.a.createElement(T.Provider,{value:[s,C(l)]},t)}function L(){var e=r.a.useContext(T);if(void 0===e)throw new Error("useUser must be used within a UserProvider");return e}var S=function(){var e=L(),t=Object(u.a)(e,2),a=t[0],n=a.isUserLoggedIn,c=a.email,s=t[1];return!n&&localStorage.getItem("token")&&s({type:"CHECK_TOKEN"}),r.a.createElement(m.a,{variant:"light",bg:"light",expand:"lg"},r.a.createElement(i.a,{className:"justify-content-center"},r.a.createElement(m.a.Brand,{className:"w-50 mr-auto"},r.a.createElement("i",{className:"fas fa-quote-right"})," ",r.a.createElement("span",{className:"lead"},n?"Hello, ".concat(c.split("@")[0],"!"):"Yellow Notes")),n&&r.a.createElement(d.a,{variant:"outline-success",className:"d-lg-none mr-2"},r.a.createElement("i",{className:"fas fa-bars mr-1"}),"Text"),r.a.createElement(m.a.Toggle,{"aria-controls":"navbar-nav"}),r.a.createElement(m.a.Collapse,{id:"navbar-nav",className:"w-100"},n&&r.a.createElement(p.a,{className:"w-100 justify-content-center"},r.a.createElement(d.a,{variant:"outline-success",className:"d-none d-lg-block"},r.a.createElement("i",{className:"fas fa-bars mr-1"}),"Text")),r.a.createElement(p.a,{className:"w-100 ml-auto justify-content-end mt-2 mt-lg-0 flex-lg-row flex-row-reverse"},n?r.a.createElement(d.a,{variant:"outline-danger",onClick:function(){return s({type:"LOGOUT"})}},r.a.createElement("i",{className:"fas fa-sign-out-alt mr-1"}),"Sign out"):r.a.createElement(l.b,{to:"/",className:"btn btn-outline-primary"},r.a.createElement("i",{className:"fas fa-sign-in-alt mr-1"}),"Sign in")))))},B=a(25),U=a(115),G=a(72),A=a(117),D=a(71),F=a(114),_=a(121),q=a(113),P=function(e){var t=e.children,a=e.text,c=e.show,s=Object(n.useRef)(),l=(Array.isArray(t)?t[0]:t)||r.a.createElement("div",{ref:s});if(null===l.ref)throw new Error("First child has to have a ref defined!");var o=l.ref.current;return r.a.createElement(r.a.Fragment,null,t||l,r.a.createElement(_.a,Object.assign({},e,{target:o,show:c}),r.a.createElement(q.a,e,a)))},V=function(e){var t=e.state,a=e.onTextChanged,c=e.onBlur;return r.a.createElement(D.a,{className:"row justify-content-center"},r.a.createElement(F.a,null,r.a.createElement(F.a.Prepend,null,r.a.createElement(F.a.Text,{className:"bg-white"},r.a.createElement("i",{className:"fas fa-at fa-fw m-auto"}))),r.a.createElement(P,{text:"Enter a valid e-mail address!",show:t.wasBlurred&&t.isValid,placement:"right"},r.a.createElement(A.a.Control,{required:!0,id:"email",type:"email",placeholder:"Email address",ref:Object(n.useRef)(),value:t.email,onChange:a,onBlur:c}))))},K=function(e){var t=e.state,a=e.onTextChanged,c=e.onBlur;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{className:"row justify-content-center"},r.a.createElement(F.a,null,r.a.createElement(F.a.Prepend,null,r.a.createElement(F.a.Text,{className:"bg-white"},r.a.createElement("i",{className:"fas fa-hashtag fa-fw m-auto"}))),r.a.createElement(P,{text:"Password must contain at least 1 upper and lower case letter, 1 numeric character and be no less than 5 characters long!",show:t.wasBlurred&&t.isValid,placement:"right"},r.a.createElement(A.a.Control,{required:!0,pattern:"^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{5,}$",type:"password",placeholder:"Password",ref:Object(n.useRef)(),value:t.value,onChange:a,onBlur:c})))))},M=function(e){var t=e.disabled,a=e.icon,n=e.title;return r.a.createElement(d.a,{variant:"outline-primary",block:!0,type:"submit",disabled:t},r.a.createElement("i",{className:"fas fa-".concat(a," mr-1")}),n)},H=function(e){var t=e.state,a=e.pattern,c=e.onTextChanged,s=e.onBlur;return r.a.createElement(D.a,{className:"row justify-content-center"},r.a.createElement(F.a,null,r.a.createElement(F.a.Prepend,null,r.a.createElement(F.a.Text,{className:"bg-white"},r.a.createElement("i",{className:"fas fa-redo fa-fw m-auto"}))),r.a.createElement(P,{text:"Passwords do not match!",show:t.wasBlurred&&!!t.value&&a!==t.value,placement:"right"},r.a.createElement(A.a.Control,{required:!0,pattern:a,id:"passwordRepeat",type:"password",placeholder:"Repeat Password",ref:Object(n.useRef)(),value:t.value,onChange:c,onBlur:s}))))},Y=function(e){var t=e.onClick;return r.a.createElement(D.a,{className:"row justify-content-center my-4"},r.a.createElement(A.a.Check,{custom:!0,id:"1",type:"checkbox",label:"I agree to the terms and conditions",onClick:t}))},z=function(){var e=Object(n.useState)({email:{value:"",isValid:!1},password:{value:"",isValid:!1},passwordRepeat:{value:"",isValid:!1},termsAccepted:!1}),t=Object(u.a)(e,2),a=t[0],c=t[1],s=L(),l=Object(u.a)(s,2),i=l[0],m=l[1],d=a.email,p=a.password,E=a.passwordRepeat,g=a.termsAccepted,b=function(e){return function(t){var n=t.target,r=n.validity,s=n.value,l=r.patternMismatch||r.typeMismatch;c(Object(f.a)({},a,Object(B.a)({},e,{value:s,isValid:l})))}},h=function(e){return function(){a[e].wasBlurred||c(Object(f.a)({},a,Object(B.a)({},e,Object(f.a)({},a[e],{wasBlurred:!0}))))}};return r.a.createElement(r.a.Fragment,null,i.isUserLoggedIn&&r.a.createElement(o.a,{to:"notes"}),r.a.createElement(U.a,{className:"justify-content-center"},r.a.createElement(G.a,{xs:11,lg:8,className:"my-4"},r.a.createElement("h1",{className:"display-4 text-center"},"Register an account"))),r.a.createElement(U.a,{className:"justify-content-center"},r.a.createElement(G.a,{xs:11,lg:6,className:"my-2"},r.a.createElement(A.a,{onSubmit:function(e){e.preventDefault(),e.target.className+=" was-validated",e.target.checkValidity()&&m({type:"REGISTER",payload:{email:a.email.value,password:a.password.value}})},className:"needs-validation",noValidate:!0},r.a.createElement(V,{onTextChanged:b("email"),onBlur:h("email"),state:d}),r.a.createElement(K,{onTextChanged:b("password"),onBlur:h("password"),state:p}),r.a.createElement(H,{pattern:p.value,onTextChanged:b("passwordRepeat"),onBlur:h("passwordRepeat"),state:E}),r.a.createElement(Y,{onClick:function(){c(Object(f.a)({},a,{termsAccepted:!g}))}}),r.a.createElement(M,{disabled:!g,icon:"user-plus",title:"Create new account"})))))},J=function(){var e=L(),t=Object(u.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)({email:"",password:""}),i=Object(u.a)(s,2),m=i[0],p=i[1],E=m.email,g=m.password,b=""===E||""===g,h=function(e){return function(t){var a=t.target;p(Object(f.a)({},m,Object(B.a)({},e,a.value)))}};return r.a.createElement(r.a.Fragment,null,a.isUserLoggedIn&&r.a.createElement(o.a,{to:"notes"}),r.a.createElement(U.a,{className:"justify-content-center"},r.a.createElement(G.a,{xs:11,className:"my-4"},r.a.createElement("h1",{className:"display-4 text-center"},"Welcome to Yellow Notes!"))),r.a.createElement(U.a,{className:"justify-content-center"},r.a.createElement(G.a,{xs:11,lg:6,className:"my-2"},r.a.createElement(A.a,{onSubmit:function(e){e.preventDefault(),b||c({type:"LOGIN",payload:Object(f.a)({},m)})},noValidate:!0},r.a.createElement(V,{onTextChanged:h("email"),state:E}),r.a.createElement(K,{onTextChanged:h("password"),state:g}),r.a.createElement(M,{disabled:b,icon:"home",title:"Login"}),r.a.createElement("hr",null),r.a.createElement("p",{className:"lead text-center"},"Or"," ",r.a.createElement(l.b,{to:"/registration"},r.a.createElement(d.a,{variant:"outline-success"},r.a.createElement("i",{className:"fas fa-user-plus mr-2"}),"Register"))," ","to create new account!")))))},W=a(120),Z=(a(107),function(e){var t=e.content;return r.a.createElement(W.a,{className:"shadow-sm"},r.a.createElement(W.a.Body,{className:"p-0"},r.a.createElement(A.a.Control,{disabled:!0,as:"textarea",className:"note-item",rows:5,value:t})))}),$=a(116),Q=a(73),X=function(){var e=L(),t=Object(u.a)(e,1)[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,null),r.a.createElement(U.a,null,t.isUserLoggedIn||r.a.createElement(o.a,{to:"/"}),!t.notes||t.notes.map((function(e){return r.a.createElement(G.a,{lg:4,className:"mt-3",key:e.id},r.a.createElement(Z,e))}))))};function ee(){var e=L(),t=Object(u.a)(e,2)[1],a=Object(n.useState)(""),c=Object(u.a)(a,2),s=c[0],l=c[1];return r.a.createElement($.a,{className:"mt-3 mb-3 shadow-sm"},r.a.createElement(Q.a,null,r.a.createElement(A.a,{className:"d-flex",onSubmit:function(e){e.preventDefault(),""!==s&&(t({type:"ADD_NOTE",payload:{content:s}}),l(""))}},r.a.createElement(A.a.Control,{type:"text",placeholder:"New note",value:s,onChange:function(e){return l(e.target.value)}}),r.a.createElement(d.a,{variant:"outline-info",type:"submit",className:"ml-3"},r.a.createElement("i",{className:"fas fa-plus"})))))}var te=a(74),ae=a(47),ne={transition:"opacity 0.5s linear"},re=function(e){var t=e.component,a=Object(te.a)(e,["component"]);return r.a.createElement(o.b,Object.assign({},a,{render:function(e){return r.a.createElement(ae.a,{in:!0,appear:!0,style:ne},r.a.createElement("div",null,r.a.createElement(t,e)))}}))};var ce=function(){return r.a.createElement(R,null,r.a.createElement(l.a,null,r.a.createElement(S,null),r.a.createElement(i.a,null,r.a.createElement(o.d,null,r.a.createElement(re,{exact:!0,key:"0",path:"/",component:J}),r.a.createElement(re,{exact:!0,key:"1",path:"/registration",component:z}),r.a.createElement(re,{exact:!0,key:"2",path:"/notes",component:X})))))};a(108);s.a.render(r.a.createElement(ce,null),document.getElementById("root"))},76:function(e,t,a){e.exports=a(109)}},[[76,1,2]]]);
//# sourceMappingURL=main.5252c960.chunk.js.map