(this["webpackJsonpyellow-notes-frontend"]=this["webpackJsonpyellow-notes-frontend"]||[]).push([[0],{108:function(e,a,t){},110:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(16),l=t.n(c),s=t(19),o=t(24),i=t(112),u=t(8),m=t(120),d=t(113),p=t(121),E=t(76),f=t(6),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isUserLoggedIn:!1},a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"CHECK_TOKEN":return Object(f.a)({isUserLoggedIn:!!n},n);case"LOADING_START":return Object(f.a)({},e,{isLoading:!0});case"REGISTER":return Object(f.a)({},n,{isUserLoggedIn:!0});case"REGISTER_FAILED":return{isUserLoggedIn:!1,error:{type:"REGISTER",message:"This email is already registered!"}};case"LOGIN":return Object(f.a)({},n,{isUserLoggedIn:!0});case"LOGIN_FAILED":return{isUserLoggedIn:!1,error:{type:"LOGIN",message:"Wrong email or password!"}};case"CLEAR_ERROR":return Object(f.a)({},e,{error:null});case"ADD_NOTE":var r=0;return e.notes&&(r=0===e.notes.length?0:e.notes[e.notes.length-1].id+1),Object(f.a)({},e,{notes:[].concat(Object(E.a)(e.notes||[]),[Object(f.a)({},n,{id:r})])});case"LOGOUT":return{isUserLoggedIn:!1};default:return e}},b=t(14),h=t.n(b),v=t(21),w=t(61);var y=t.n(w).a.create({baseURL:"https://api.yellownotes.c1rcle.pl/",timeout:1e4,headers:localStorage.getItem("token")?{Authorization:"Bearer "+localStorage.getItem("token")}:{}}),O=function(){var e=Object(v.a)(h.a.mark((function e(a){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=a.payload)&&t.password&&t.email&&2===Object.keys(t).length){e.next=3;break}throw new Error("Registration request has invalid parameters!");case 3:return e.prev=3,e.next=6,y.post("users/register",Object(f.a)({},t));case 6:n=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),n={status:400},console.error(e.t0);case 13:if(200===n.status){e.next=15;break}return e.abrupt("return",{type:"REGISTER_FAILED"});case 15:return localStorage.setItem("token",n.data.token),e.abrupt("return",Object(f.a)({},a,{payload:{email:t.email}}));case 17:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(a){return e.apply(this,arguments)}}(),N=function(){var e=Object(v.a)(h.a.mark((function e(a){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[{id:0,content:"Some example text"},{id:1,content:"Some example text"},{id:2,content:"Some example text"},{id:3,content:"Some example text"},{id:4,content:"Multi \nline \ntext"}],(n=a.payload)&&n.password&&n.email&&2===Object.keys(n).length){e.next=4;break}throw new Error("Login request has invalid parameters!");case 4:return e.prev=4,e.next=7,y.post("users/authenticate",n);case 7:r=e.sent,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),r={status:400},console.error(e.t0);case 14:if(200===r.status){e.next=16;break}return e.abrupt("return",{type:"LOGIN_FAILED"});case 16:return localStorage.setItem("token",r.data.token),e.abrupt("return",Object(f.a)({},a,{payload:{email:n.email,notes:t}}));case 18:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(a){return e.apply(this,arguments)}}(),x=function(){var e=Object(v.a)(h.a.mark((function e(a){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.payload&&a.payload.content&&1===Object.keys(a.payload).length){e.next=2;break}throw new Error("Registration request has invalid parameters!");case 2:e.prev=2,t={status:200,data:{content:a.payload.content}},e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(2),new Error("Add note action has failed! ",t);case 9:if(200===t.status){e.next=11;break}throw new Error("Add note action has failed! ",t);case 11:return e.abrupt("return",Object(f.a)({},a,{payload:t.data}));case 12:case"end":return e.stop()}}),e,null,[[2,6]])})));return function(a){return e.apply(this,arguments)}}(),j=t(62),k=t.n(j),I=function(){var e=Object(v.a)(h.a.mark((function e(a){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("token")){e.next=3;break}return e.abrupt("return",a);case 3:if(!((n=k()(t)).exp<(new Date).getTime()/1e3)&&n.email){e.next=7;break}return localStorage.removeItem("token"),e.abrupt("return");case 7:return e.abrupt("return",Object(f.a)({},a,{payload:{isUserLoggedIn:!0,email:n.email}}));case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),L=function(e){return function(a){switch(a.type){case"CHECK_TOKEN":e({type:"LOADING_START"}),I(a).then((function(a){return e(a)})).catch((function(e){return console.log(e)}));break;case"REGISTER":e({type:"LOADING_START"}),O(a).then((function(a){return e(a)})).catch((function(e){return console.log(e)}));break;case"LOGIN":e({type:"LOADING_START"}),N(a).then((function(a){return e(a)})).catch((function(e){return console.log(e)}));break;case"LOGOUT":localStorage.removeItem("token"),e(a);break;case"ADD_NOTE":x(a).then((function(a){return e(a)})).catch((function(e){return console.log(e)}));break;default:e(a)}}},R=Object(n.createContext)();function T(e){var a=e.children,t=Object(n.useReducer)(g,{}),c=Object(u.a)(t,2),l=c[0],s=c[1];return r.a.createElement(R.Provider,{value:[l,L(s)]},a)}function C(){var e=r.a.useContext(R);if(void 0===e)throw new Error("useUser must be used within a UserProvider");return e}var S=function(){var e=C(),a=Object(u.a)(e,2),t=a[0],n=t.isUserLoggedIn,c=t.email,l=a[1];return!n&&localStorage.getItem("token")&&l({type:"CHECK_TOKEN"}),r.a.createElement(m.a,{variant:"light",bg:"light",expand:"lg"},r.a.createElement(i.a,{className:"justify-content-center"},r.a.createElement(m.a.Brand,{className:"w-50 mr-auto"},r.a.createElement("i",{className:"fas fa-quote-right"})," ",r.a.createElement("span",{className:"lead"},n?"Hello, ".concat(c.split("@")[0],"!"):"Yellow Notes")),n&&r.a.createElement(d.a,{variant:"outline-success",className:"d-lg-none mr-2"},r.a.createElement("i",{className:"fas fa-bars mr-1"}),"Text"),r.a.createElement(m.a.Toggle,{"aria-controls":"navbar-nav"}),r.a.createElement(m.a.Collapse,{id:"navbar-nav",className:"w-100"},n&&r.a.createElement(p.a,{className:"w-100 justify-content-center"},r.a.createElement(d.a,{variant:"outline-success",className:"d-none d-lg-block"},r.a.createElement("i",{className:"fas fa-bars mr-1"}),"Text")),r.a.createElement(p.a,{className:"w-100 ml-auto justify-content-end mt-2 mt-lg-0 flex-lg-row flex-row-reverse"},n?r.a.createElement(d.a,{variant:"outline-danger",onClick:function(){return l({type:"LOGOUT"})}},r.a.createElement("i",{className:"fas fa-sign-out-alt mr-1"}),"Sign out"):r.a.createElement(s.b,{to:"/",className:"btn btn-outline-primary"},r.a.createElement("i",{className:"fas fa-sign-in-alt mr-1"}),"Sign in")))))},A=t(27),G=t(117),B=t(73),D=t(119),U=t(72),_=t(115),F=t(122),P=t(114),V=function(e){var a=e.children,t=e.text,c=e.show,l=Object(n.useRef)(),s=(Array.isArray(a)?a[0]:a)||r.a.createElement("div",{ref:l});if(null===s.ref)throw new Error("First child has to have a ref defined!");var o=s.ref.current;return r.a.createElement(r.a.Fragment,null,a||s,r.a.createElement(F.a,Object.assign({},e,{target:o,show:c}),r.a.createElement(P.a,e,t)))},q=function(e){var a=e.state,t=e.onTextChanged,c=e.onBlur;return r.a.createElement(U.a,{className:"row justify-content-center"},r.a.createElement(_.a,null,r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,{className:"bg-white"},r.a.createElement("i",{className:"fas fa-at fa-fw m-auto"}))),r.a.createElement(V,{text:"Enter a valid e-mail address!",show:a.wasBlurred&&a.isValid,placement:"right"},r.a.createElement(D.a.Control,{required:!0,id:"email",type:"email",placeholder:"Email address",ref:Object(n.useRef)(),value:a.email,onChange:t,onBlur:c}))))},K=function(e){var a=e.state,t=e.onTextChanged,c=e.onBlur;return r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{className:"row justify-content-center"},r.a.createElement(_.a,null,r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,{className:"bg-white"},r.a.createElement("i",{className:"fas fa-hashtag fa-fw m-auto"}))),r.a.createElement(V,{text:"Password must contain at least 1 upper and lower case letter, 1 numeric character and be no less than 5 characters long!",show:a.wasBlurred&&a.isValid,placement:"right"},r.a.createElement(D.a.Control,{required:!0,pattern:"^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{5,}$",type:"password",placeholder:"Password",ref:Object(n.useRef)(),value:a.value,onChange:t,onBlur:c})))))},H=t(116),z=function(){return r.a.createElement(H.a,{animation:"border",role:"status",size:"sm"},r.a.createElement("span",{className:"sr-only"},"Loading..."))},M=function(e){var a=e.disabled,t=e.icon,n=e.title,c=e.isLoading;return r.a.createElement(d.a,{variant:"outline-primary",block:!0,type:"submit",disabled:a||c},c?r.a.createElement(r.a.Fragment,null,r.a.createElement(z,null)," "):r.a.createElement("i",{className:"fas fa-".concat(t," mr-1")}),n)},W=function(e){var a=e.state,t=e.pattern,c=e.onTextChanged,l=e.onBlur;return r.a.createElement(U.a,{className:"row justify-content-center"},r.a.createElement(_.a,null,r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,{className:"bg-white"},r.a.createElement("i",{className:"fas fa-redo fa-fw m-auto"}))),r.a.createElement(V,{text:"Passwords do not match!",show:a.wasBlurred&&!!a.value&&t!==a.value,placement:"right"},r.a.createElement(D.a.Control,{required:!0,pattern:t,id:"passwordRepeat",type:"password",placeholder:"Repeat Password",ref:Object(n.useRef)(),value:a.value,onChange:c,onBlur:l}))))},J=function(e){var a=e.onClick;return r.a.createElement(U.a,{className:"row justify-content-center my-4"},r.a.createElement(D.a.Check,{custom:!0,id:"1",type:"checkbox",label:"I agree to the terms and conditions",onClick:a}))},Y=function(){var e=Object(n.useState)({email:{value:"",isValid:!1},password:{value:"",isValid:!1},passwordRepeat:{value:"",isValid:!1},termsAccepted:!1}),a=Object(u.a)(e,2),t=a[0],c=a[1],l=C(),s=Object(u.a)(l,2),i=s[0],m=s[1],d=t.email,p=t.password,E=t.passwordRepeat,g=t.termsAccepted,b=function(e){return function(a){var n=a.target,r=n.validity,l=n.value,s=r.patternMismatch||r.typeMismatch;c(Object(f.a)({},t,Object(A.a)({},e,{value:l,isValid:s})))}},h=function(e){return function(){t[e].wasBlurred||c(Object(f.a)({},t,Object(A.a)({},e,Object(f.a)({},t[e],{wasBlurred:!0}))))}};return r.a.createElement(r.a.Fragment,null,i.isUserLoggedIn&&r.a.createElement(o.a,{to:"notes"}),r.a.createElement(G.a,{className:"justify-content-center"},r.a.createElement(B.a,{xs:11,lg:8,className:"my-4"},r.a.createElement("h1",{className:"display-4 text-center"},"Register an account"))),r.a.createElement(G.a,{className:"justify-content-center"},r.a.createElement(B.a,{xs:11,lg:6,className:"my-2"},r.a.createElement(D.a,{onSubmit:function(e){e.preventDefault(),e.target.className+=" was-validated",e.target.checkValidity()&&m({type:"REGISTER",payload:{email:t.email.value,password:t.password.value}})},className:"needs-validation",noValidate:!0},r.a.createElement(q,{onTextChanged:b("email"),onBlur:h("email"),state:d}),r.a.createElement(K,{onTextChanged:b("password"),onBlur:h("password"),state:p}),r.a.createElement(W,{pattern:p.value,onTextChanged:b("passwordRepeat"),onBlur:h("passwordRepeat"),state:E}),r.a.createElement(J,{onClick:function(){c(Object(f.a)({},t,{termsAccepted:!g}))}}),r.a.createElement(M,{disabled:!g,icon:"user-plus",title:"Create new account",isLoading:i.isLoading})))))},Z=function(){var e=C(),a=Object(u.a)(e,2),t=a[0],c=a[1],l=Object(n.useState)({email:"",password:""}),i=Object(u.a)(l,2),m=i[0],p=i[1],E=m.email,g=m.password,b=""===E||""===g,h=function(e){return function(a){var t=a.target;p(Object(f.a)({},m,Object(A.a)({},e,t.value)))}};return r.a.createElement(r.a.Fragment,null,t.isUserLoggedIn&&r.a.createElement(o.a,{to:"notes"}),r.a.createElement(G.a,{className:"justify-content-center"},r.a.createElement(B.a,{xs:11,className:"my-4"},r.a.createElement("h1",{className:"display-4 text-center"},"Welcome to Yellow Notes!"))),r.a.createElement(G.a,{className:"justify-content-center"},r.a.createElement(B.a,{xs:11,lg:6,className:"my-2"},r.a.createElement(D.a,{onSubmit:function(e){e.preventDefault(),b||c({type:"LOGIN",payload:Object(f.a)({},m)})},noValidate:!0},r.a.createElement(q,{onTextChanged:h("email"),state:E}),r.a.createElement(K,{onTextChanged:h("password"),state:g}),r.a.createElement(M,{disabled:b,icon:"home",title:"Login",isLoading:t.isLoading}),r.a.createElement("hr",null),r.a.createElement("p",{className:"lead text-center"},"Or"," ",r.a.createElement(s.b,{to:"/registration"},r.a.createElement(d.a,{variant:"outline-success"},r.a.createElement("i",{className:"fas fa-user-plus mr-2"}),"Register"))," ","to create new account!")))))},$=t(123),Q=(t(108),function(e){var a=e.content;return r.a.createElement($.a,{className:"shadow-sm"},r.a.createElement($.a.Body,{className:"p-0"},r.a.createElement(D.a.Control,{disabled:!0,as:"textarea",className:"note-item",rows:5,value:a})))}),X=t(118),ee=t(74),ae=function(){var e=C(),a=Object(u.a)(e,1)[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement(te,null),r.a.createElement(G.a,null,a.isUserLoggedIn||r.a.createElement(o.a,{to:"/"}),!a.notes||a.notes.map((function(e){return r.a.createElement(B.a,{lg:4,className:"mt-3",key:e.id},r.a.createElement(Q,e))}))))};function te(){var e=C(),a=Object(u.a)(e,2)[1],t=Object(n.useState)(""),c=Object(u.a)(t,2),l=c[0],s=c[1];return r.a.createElement(X.a,{className:"mt-3 mb-3 shadow-sm"},r.a.createElement(ee.a,null,r.a.createElement(D.a,{className:"d-flex",onSubmit:function(e){e.preventDefault(),""!==l&&(a({type:"ADD_NOTE",payload:{content:l}}),s(""))}},r.a.createElement(D.a.Control,{type:"text",placeholder:"New note",value:l,onChange:function(e){return s(e.target.value)}}),r.a.createElement(d.a,{variant:"outline-info",type:"submit",className:"ml-3"},r.a.createElement("i",{className:"fas fa-plus"})))))}var ne=t(75),re=t(31),ce={transition:"opacity 0.5s linear"},le=function(e){var a=e.component,t=Object(ne.a)(e,["component"]);return r.a.createElement(o.b,Object.assign({},t,{render:function(e){return r.a.createElement(re.a,{in:!0,appear:!0,style:ce},r.a.createElement("div",null,r.a.createElement(a,e)))}}))},se=t(124),oe=function(){var e=C(),a=Object(u.a)(e,2),t=a[0],n=a[1];return t.error?(setTimeout((function(){return n({type:"CLEAR_ERROR"})}),5e3),r.a.createElement(se.a,{variant:"danger",className:"mt-3 mb-0"},r.a.createElement("strong",null,"We have encountered an error!")," ",t.error.message)):null};var ie=function(){return r.a.createElement(T,null,r.a.createElement(s.a,null,r.a.createElement(S,null),r.a.createElement(i.a,null,r.a.createElement(oe,null),r.a.createElement(o.d,null,r.a.createElement(le,{exact:!0,key:"0",path:"/",component:Z}),r.a.createElement(le,{exact:!0,key:"1",path:"/registration",component:Y}),r.a.createElement(le,{exact:!0,key:"2",path:"/notes",component:ae})))))};t(109);l.a.render(r.a.createElement(ie,null),document.getElementById("root"))},77:function(e,a,t){e.exports=t(110)}},[[77,1,2]]]);
//# sourceMappingURL=main.b3d87a96.chunk.js.map